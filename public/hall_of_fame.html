<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–ª –°–ª–∞–≤—ã - –ü–∞—Ç–∏-–†–∞–π—Ö</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap');

        .imperial-font { font-family: 'Cinzel', serif; }
        .modern-font { font-family: 'Inter', sans-serif; }

        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .card-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .royal-border {
            border: 3px solid;
            border-image: linear-gradient(45deg, #ffd700, #ffed4e, #ffd700) 1;
        }
    </style>
</head>
<body class="modern-font gradient-bg min-h-screen">
<div x-data="hallOfFame()" x-init="loadUsers()" class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="text-center mb-8">
        <h1 class="imperial-font text-5xl font-bold text-white mb-4 drop-shadow-lg">
            üèÜ –ó–ê–õ –°–õ–ê–í–´ üèÜ
        </h1>
        <p class="text-xl text-white/90 imperial-font">
            –ü–æ—á–µ—Ç–Ω—ã–µ –ü–æ–¥–¥–∞–Ω–Ω—ã–µ –ü–∞—Ç–∏-–†–∞–π—Ö–∞
        </p>
        <p class="text-lg text-white/80 mt-2">
            –í–æ —Å–ª–∞–≤—É Party Kaiser –∏ —Å–≤—è—â–µ–Ω–Ω–æ–≥–æ –±—Ä–∞—Ç—Å—Ç–≤–∞
        </p>

        <!-- Navigation -->
        <div class="mt-6 space-x-4">
            <a href="/" class="bg-white/20 text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-colors">
                üè∞ –ì–ª–∞–≤–Ω–∞—è
            </a>
            <a href="/profile" class="bg-white/20 text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-colors">
                üë§ –ü—Ä–æ—Ñ–∏–ª—å
            </a>
        </div>
    </div>

    <!-- Search and Filter -->
    <div class="max-w-4xl mx-auto mb-8 bg-white rounded-2xl card-shadow p-6">
        <div class="flex flex-col md:flex-row gap-4 items-center">
            <div class="flex-1">
                <input
                        x-model="searchTerm"
                        @input="filterUsers"
                        type="text"
                        placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ —Ç–∏—Ç—É–ª—É..."
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                >
            </div>
            <div class="flex items-center space-x-4">
                <select
                        x-model="sortBy"
                        @change="sortUsers"
                        class="px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition-colors"
                >
                    <option value="newest">–ù–æ–≤–µ–π—à–∏–µ</option>
                    <option value="oldest">–°—Ç–∞—Ä–µ–π—à–∏–µ</option>
                    <option value="name">–ü–æ –∏–º–µ–Ω–∏</option>
                </select>
                <span class="text-gray-600 font-semibold" x-text="`${filteredUsers.length} –ø–æ–¥–¥–∞–Ω–Ω—ã—Ö`"></span>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div x-show="loading" class="text-center py-12">
        <div class="inline-flex items-center text-white text-xl">
            <svg class="animate-spin h-8 w-8 mr-3" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
                <path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            –ó–∞–≥—Ä—É–∑–∫–∞ –ó–∞–ª–∞ –°–ª–∞–≤—ã...
        </div>
    </div>

    <!-- Error Message -->
    <div x-show="error" class="max-w-4xl mx-auto mb-8 bg-red-100 border border-red-400 text-red-700 px-6 py-4 rounded-lg">
        <p x-text="error" class="text-center font-semibold"></p>
    </div>

    <!-- Users Grid -->
    <div x-show="!loading && filteredUsers.length > 0" class="max-w-6xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <template x-for="user in filteredUsers" :key="user.id">
                <div class="bg-white rounded-2xl card-shadow overflow-hidden transform hover:scale-105 transition-all duration-200">
                    <!-- User Header -->
                    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 p-4 text-white">
                        <h3 class="imperial-font text-xl font-bold text-center" x-text="user.full_name"></h3>
                        <p class="text-center text-purple-200" x-text="`@${user.username}`"></p>
                        <p class="text-center text-sm text-purple-200 mt-1" x-text="user.location || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∑–µ–º–ª–∏'"></p>
                    </div>

                    <!-- Title Display -->
                    <div class="p-6">
                        <div class="bg-yellow-50 rounded-lg p-4 mb-4 royal-border">
                            <h4 class="imperial-font text-lg font-semibold text-purple-800 mb-2 text-center">
                                üëë –¢–∏—Ç—É–ª
                            </h4>
                            <p class="text-gray-800 text-center leading-relaxed" x-text="user.title"></p>
                        </div>

                        <div class="text-center text-sm text-gray-500">
                            <p>–ü–æ–¥–¥–∞–Ω–Ω—ã–π —Å <span x-text="formatDate(user.created_at)"></span></p>
                        </div>
                    </div>

                    <!-- Crown Animation -->
                    <div class="absolute top-2 right-2 text-2xl animate-pulse">
                        üëë
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- No Results -->
    <div x-show="!loading && filteredUsers.length === 0 && !error" class="text-center py-12">
        <div class="text-6xl mb-4">üè∞</div>
        <h2 class="imperial-font text-3xl text-white mb-4">–ó–∞–ª –°–ª–∞–≤—ã –ü—É—Å—Ç</h2>
        <p class="text-xl text-white/80 mb-6">–ü–æ–∫–∞ —á—Ç–æ –Ω–∏ –æ–¥–∏–Ω –ø–æ–¥–¥–∞–Ω–Ω—ã–π –Ω–µ –ø—Ä–∏–Ω—ë—Å –∫–ª—è—Ç–≤—É –≤–µ—Ä–Ω–æ—Å—Ç–∏</p>
        <a href="/" class="bg-white text-purple-600 px-6 py-3 rounded-lg font-bold text-lg hover:bg-gray-100 transition-colors">
            –°—Ç–∞—Ç—å –ü–µ—Ä–≤—ã–º –ü–æ–¥–¥–∞–Ω–Ω—ã–º
        </a>
    </div>

    <!-- Statistics -->
    <div x-show="!loading && users.length > 0" class="max-w-4xl mx-auto mt-12 bg-white/10 backdrop-blur-sm rounded-2xl p-8">
        <h2 class="imperial-font text-3xl font-bold text-white text-center mb-6">
            üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ü–∞—Ç–∏-–†–∞–π—Ö–∞
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
            <div class="bg-white/20 rounded-xl p-6">
                <div class="text-4xl mb-2">üë•</div>
                <div class="text-3xl font-bold text-white" x-text="users.length"></div>
                <div class="text-white/80">–í—Å–µ–≥–æ –ü–æ–¥–¥–∞–Ω–Ω—ã—Ö</div>
            </div>
            <div class="bg-white/20 rounded-xl p-6">
                <div class="text-4xl mb-2">üèÜ</div>
                <div class="text-3xl font-bold text-white" x-text="users.length"></div>
                <div class="text-white/80">–¢–∏—Ç—É–ª–æ–≤ –î–∞—Ä–æ–≤–∞–Ω–æ</div>
            </div>
            <div class="bg-white/20 rounded-xl p-6">
                <div class="text-4xl mb-2">‚öîÔ∏è</div>
                <div class="text-3xl font-bold text-white" x-text="users.length"></div>
                <div class="text-white/80">–ö–ª—è—Ç–≤ –ü—Ä–∏–Ω–µ—Å–µ–Ω–æ</div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center text-white/80 mt-12">
        <p class="text-lg imperial-font">
            üçæ –í–æ —Å–ª–∞–≤—É –≤—Å–µ—Ö –±–ª–∞–≥–æ—Ä–æ–¥–Ω—ã—Ö –ø–æ–¥–¥–∞–Ω–Ω—ã—Ö –ü–∞—Ç–∏-–†–∞–π—Ö–∞ üçæ
        </p>
        <p class="text-sm mt-2">
            –î–∞ –∑–¥—Ä–∞–≤—Å—Ç–≤—É–µ—Ç Party Kaiser –∏ —Å–≤—è—â–µ–Ω–Ω–æ–µ –±—Ä–∞—Ç—Å—Ç–≤–æ!
        </p>
    </footer>
</div>

<script>
    function hallOfFame() {
        return {
            users: [],
            filteredUsers: [],
            searchTerm: '',
            sortBy: 'newest',
            loading: false,
            error: '',

            async loadUsers() {
                this.loading = true;
                this.error = '';

                try {
                    const response = await fetch('/api/hall-of-fame');
                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
                    }

                    this.users = data;
                    this.filteredUsers = [...data];
                    this.sortUsers();

                } catch (error) {
                    this.error = error.message || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞';
                } finally {
                    this.loading = false;
                }
            },

            filterUsers() {
                const term = this.searchTerm.toLowerCase();
                this.filteredUsers = this.users.filter(user =>
                    user.full_name.toLowerCase().includes(term) ||
                    user.username.toLowerCase().includes(term) ||
                    user.title.toLowerCase().includes(term) ||
                    (user.location && user.location.toLowerCase().includes(term))
                );
                this.sortUsers();
            },

            sortUsers() {
                switch (this.sortBy) {
                    case 'newest':
                        this.filteredUsers.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                        break;
                    case 'oldest':
                        this.filteredUsers.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));
                        break;
                    case 'name':
                        this.filteredUsers.sort((a, b) => a.full_name.localeCompare(b.full_name));
                        break;
                }
            },

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ru-RU', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
        }
    }
</script>
</body>
</html>